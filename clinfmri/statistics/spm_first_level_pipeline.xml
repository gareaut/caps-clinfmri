
<pipeline capsul_xml="2.0">
  <doc>SPM8 fMRI First Level Analysis.

        .. note::

            * `fmri_sessions` and `behavioral_data` must have the same number
              of elements.
            * `onsets` and `durations` values must have the same units as the
              TR used in the unitsings (ie. seconds).
            set name="mask_threshold" value="-Inf"</doc>
  <process name="normalize_rp" module="mmutils.adapters.converted_io.normalize_array"/>
  <process name="list_to_element_adapter" module="mmutils.adapters.converted_io.list_to_element"/>
  <process name="extract_wm_regressors" module="clinfmri.statistics.extract_non_interrest_reg">
    <set name="regions_label" value="'wm'"/>
    <set name="region_ids" value="None"/>
    <set name="verbose" value="1"/>
    <set name="output_directory" value="None"/>
  </process>
  <process name="extract_csf_regressors" module="clinfmri.statistics.extract_non_interrest_reg">
    <set name="regions_label" value="'ventricles'"/>
    <set name="region_ids" value="None"/>
    <set name="verbose" value="1"/>
    <set name="output_directory" value="None"/>
  </process>
  <process name="add_wm_reg" module="clinfmri.statistics.csf_covars.complete_regressors_file">
    <set name="add_extra_mvt_reg" value="True"/>
    <set name="output_directory" value="None"/>
  </process>
  <process name="add_csf_reg" module="clinfmri.statistics.csf_covars.complete_regressors_file">
    <set name="add_extra_mvt_reg" value="False"/>
    <set name="output_directory" value="None"/>
  </process>
  <process name="smoother" module="nipype.interfaces.spm.Smooth">
    <set name="in_files" value="None"/>
    <set name="data_type" value="0"/>
    <set name="implicit_masking" value="False"/>
    <set name="out_prefix" value="'s'"/>
    <set name="output_directory" value="None"/>
    <nipype name="in_files" copyfile="discard"/>
  </process>
  <process name="no_process" module="mmutils.adapters.converted_io.noprocess_switch"/>
  <process name="model" module="clinfmri.statistics.spm_model_specification.spm_model_specification">
    <set name="output_directory" value="None"/>
  </process>
  <process name="design" module="nipype.interfaces.spm.Level1Design">
    <set name="output_directory" value="None"/>
    <set name="timing_units" value="'secs'"/>
    <set name="microtime_resolution" value="16"/>
    <set name="microtime_onset" value="1"/>
    <set name="volterra_expansion_order" value="1"/>
    <set name="global_intensity_normalization" value="'none'"/>
    <set name="model_serial_correlations" value="'AR(1)'"/>
    <set name="factor_info" value="[{'name': {}}, {'levels': {}}]"/>
    <set name="bases" value="{'hrf': {'derivs': [0, 0]}}"/>
    <set name="use_v8struct" value="True"/>
    <set name="mfile" value="True"/>
  </process>
  <process name="estimate" module="nipype.interfaces.spm.EstimateModel">
    <set name="output_directory" value="None"/>
    <set name="estimation_method" value="{'Classical': 1}"/>
    <set name="use_v8struct" value="True"/>
    <set name="mfile" value="True"/>
  </process>
  <process name="contrast" module="nipype.interfaces.spm.EstimateContrast">
    <set name="output_directory" value="None"/>
    <set name="beta_images" value="None"/>
    <set name="residual_image" value="None"/>
    <nipype name="beta_images" copyfile="discard"/>
    <nipype name="residual_image" copyfile="discard"/>
  </process>
  <process name="encoding" module="clinfmri.statistics.spm_utils.spm_image_nii_encoding">
    <set name="output_directory" value="None"/>
  </process>
  <processes_selection name="smoother_switch">
    <processes_group name="do_smoothing">
      <process name="smoother"/>
    </processes_group>
    <processes_group name="no_smoothing">
      <process name="no_process"/>
    </processes_group>
  </processes_selection>
  <processes_selection name="complete_regressors">
    <processes_group name="no">
      <process name="normalize_rp"/>
    </processes_group>
    <processes_group name="yes">
      <process name="list_to_element_adapter"/>
      <process name="extract_wm_regressors"/>
      <process name="extract_csf_regressors"/>
      <process name="add_wm_reg"/>
      <process name="add_csf_reg"/>
    </processes_group>
  </processes_selection>
  <link source="smoother._smoothed_files" dest="model.fmri_sessions"/>
  <link source="no_process.output_value" dest="model.fmri_sessions"/>
  <link source="time_repetition" dest="design.interscan_interval"/>
  <link source="model.session_info" dest="design.session_info"/>
  <link source="design._spm_mat_file" dest="estimate.spm_mat_file"/>
  <link source="estimate._spm_mat_file" dest="contrast.spm_mat_file"/>
  <link source="estimate._residual_image" dest="contrast.residual_image"/>
  <link source="estimate._beta_images" dest="contrast.beta_images"/>
  <link source="contrasts" dest="encoding.contrasts"/>
  <link source="contrast._spmF_images" dest="encoding.spmF_images"/>
  <link source="contrast._spmT_images" dest="encoding.spmT_images"/>
  <link source="contrast._con_images" dest="encoding.con_images"/>
  <link source="contrast._ess_images" dest="encoding.ess_images"/>
  <link source="extract_wm_regressors.covars" dest="add_wm_reg.covars_file"/>
  <link source="add_wm_reg.covars" dest="add_csf_reg.input_file"/>
  <link source="extract_csf_regressors.covars" dest="add_csf_reg.covars_file"/>
  <link source="list_to_element_adapter.element" dest="extract_csf_regressors.fmri_file"/>
  <link source="list_to_element_adapter.element" dest="extract_wm_regressors.fmri_file"/>
  <link source="add_csf_reg.covars" dest="model.realignment_parameters"/>
  <link source="normalize_rp.outfile" dest="model.realignment_parameters"/>
  <link source="erode_path_nb_csf" dest="extract_csf_regressors.erode_path_nb"/>
  <link source="erode_path_nb_wm" dest="extract_wm_regressors.erode_path_nb"/>
  <link source="mask_image" dest="design.mask_image"/>
  <link source="fwhm" dest="smoother.fwhm"/>
  <link source="fmri_sessions" dest="smoother.in_files"/>
  <link source="fmri_sessions" dest="no_process.input_value"/>
  <link source="behavioral_data" dest="model.behavioral_data"/>
  <link source="onset_name" dest="model.onset_name"/>
  <link source="condition_name" dest="model.condition_name"/>
  <link source="time_repetition" dest="model.time_repetition"/>
  <link source="start" dest="model.start"/>
  <link source="high_pass_filter_cutoff" dest="model.high_pass_filter_cutoff"/>
  <link source="bases" dest="design.bases"/>
  <link source="contrasts" dest="contrast.contrasts"/>
  <link source="delimiter" dest="model.delimiter"/>
  <link source="duration_name" dest="model.duration_name"/>
  <link source="concatenate_runs" dest="model.concatenate_runs"/>
  <link source="fsdir" dest="extract_wm_regressors.fsdir"/>
  <link source="fsdir" dest="extract_csf_regressors.fsdir"/>
  <link source="sid" dest="extract_csf_regressors.sid"/>
  <link source="sid" dest="extract_wm_regressors.sid"/>
  <link source="w2w_mat_file" dest="extract_csf_regressors.w2wmap_file"/>
  <link source="w2w_mat_file" dest="extract_wm_regressors.w2wmap_file"/>
  <link source="fmri_sessions" dest="list_to_element_adapter.listobj"/>
  <link source="nb_extra_covars" dest="extract_csf_regressors.nb_covars"/>
  <link source="nb_extra_covars" dest="extract_wm_regressors.nb_covars"/>
  <link source="realignment_parameters" dest="add_wm_reg.input_file"/>
  <link source="realignment_parameters" dest="normalize_rp.filepath"/>
  <link source="contrast._spm_mat_file" dest="spm_contrast_mat_file"/>
  <link source="encoding.nii_spmF_images" dest="spm_F_images"/>
  <link source="encoding.nii_spmT_images" dest="spm_T_images"/>
  <link source="encoding.nii_con_images" dest="spm_con_images"/>
  <link source="encoding.nii_ess_images" dest="spm_ess_images"/>
  <link source="design._spm_mat_file" dest="spm_design_mat_file"/>
  <link source="estimate._spm_mat_file" dest="spm_estimate_mat_file"/>
  <link source="estimate._beta_images" dest="spm_beta_images"/>
  <link source="estimate._mask_image" dest="out_mask_image"/>
  <link source="estimate._RPVimage" dest="RPVimage"/>
  <link source="model.model_specifications" dest="model_specifications"/>
  <link source="extract_csf_regressors.covars" dest="non_interrest_regressors"/>
  <gui>
    <position x="-652" y="-12" name="inputs"/>
    <position x="24" y="242" name="model"/>
    <position x="178" y="-376" name="design"/>
    <position x="464" y="198" name="estimate"/>
    <position x="760" y="-194" name="contrast"/>
    <position x="1068" y="130" name="encoding"/>
    <position x="1570" y="102" name="outputs"/>
    <position x="-277" y="76" name="no_process"/>
    <position x="-290" y="-326" name="smoother"/>
    <position x="-340" y="513" name="normalize_rp"/>
    <position x="80" y="1146" name="add_csf_reg"/>
    <position x="-105" y="873" name="add_wm_reg"/>
    <position x="-367" y="1050" name="extract_csf_regressors"/>
    <position x="-373" y="742" name="extract_wm_regressors"/>
    <position x="-648" y="957" name="list_to_element_adapter"/>
    <zoom level="0.6"/>
  </gui>
</pipeline>

